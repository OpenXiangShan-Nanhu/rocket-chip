git:
  submodules: false
language: scala
sudo: required
services:
  - docker
cache:
  directories:
    $HOME/.ivy2
    emulator/verilator

env:
  global:
    - CACHE_NAME=RocketChip
    - RISCV=/opt/riscv
    - TORTURE_CONFIG=default
  matrix:
    - SUITE=RocketSuiteA
    - SUITE=RocketSuiteB
    - SUITE=RocketSuiteC
    - SUITE=GroundtestSuiteA
    - SUITE=GroundtestSuiteB
    - SUITE=UnittestSuite

# blacklist private branches
branches:
  except:
    - hwacha
    - boom
    - /^hurricane.*$/

install:
  - make verilator -C regression SUITE=none

before_install:
  - docker pull hcook/docker-riscv
  - docker run hcook/docker-riscv /bin/sh -c "cd $RISCV; ls; ls bin; date >> install2.stamp; ls; pwd;"

script:
  - docker run hcook/docker-riscv /bin/sh -c "ls $RISCV"
  - docker run hcook/docker-riscv /bin/sh -c "make emulator-ndebug -C regression SUITE=$SUITE" 
  - docker run hcook/docker-riscv /bin/sh -c "make emulator-regression-tests -C regression SUITE=$SUITE"
